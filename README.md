# Stormregion Gepard3D tooling
This repository contains tools for converting data from the file formats used by the Gepard3D engine as built by Stormregion. Currently there is support for

- SWINE maps + models (v100 models)
- PANZERS Phase 1 maps + models (v100 and some v101)
- PANZERS Phase 2 maps + models (v101 mostly)
- Rush for Berlin/the Bomb (RfB) models (maps not tested yet)

To extract the files from the game archives you'll need additional tools, see https://github.com/stormregion/community_tools (not my work).

There are two tools.

## io_scene_stormregion
An addon for Blender 3.6 which can import model files (.4d) into Blender models. Most files and structures are now supported including textures. Almost all files from the supported games should "just work".

- Textures will need to be converted to DDS with PANZERS Unpacker or similar.
- "Points" such as lights and firing positions will be converted to empties

Not understood completely yet:

- Animations/"bones". Animated figures like humans and animals will be imported but the "bones" data for animation purposes is not recreated properly. Currently it's not known how to map the bones properly to the structure.

## gepard-map-conv
A standalone Python script which can export various data from a Gepard map file as produced by the editor. All main data is parsed into Python dictionaries, but only some data has converters implemented to output the data to other formats. This tool was built originally to allow converting maps for use in Godot, especially the HTerrain plugin, and therefore the formats reflect that.

For the splatmap generation to work you'll need to export all the relevant layers from the game archives first. The script currently expects to find the layer files at line 340: "../../stormregion-tools/gepard1and2/PanzersUnpacker/extractedFiles/tiles/".

- Map header (campaign, version, description, ambient music, aircraft type, skybox choice etc)
- Heightmap (exported to a grayscale image)
- Splatmap for terrain textures/layers (first 8 layers exported to a splatmap)
- Decals
- Object and unit positions/rotations
- Roads and road junctions
- Sound effect positions
- Scripting variables (TVAR) and locations (LOCS)

Not parsed yet
- "RVR3": rivers, similar to roads
- "EEFS": effects (explosions/water spray etc)
- "MINI": Minimap image (autogenerated by the editor as a top down view for the minimap)
- "TRIG": mission triggers, partly done but parsing is specific to type

## Todos
- Exporting?

## Licence
This project is licensed under the GPL. It's free, it's open source, but don't claim it was your work. I am not responsible if it causes your cat to behave strangely.

## Some known issues/limitations
- If import fails due to a read error, try changing file_version to v100 from v101. It should be auto-detected, but this doesn't worked sometimes...


## Credits/Acknowledgements
- Pierantonio Cangianiello for java4d - https://github.com/pcan/java-4d - helped me to start understanding the file format
- MDave#5000 @ Discord for original basic Blender plugin for SWINE
